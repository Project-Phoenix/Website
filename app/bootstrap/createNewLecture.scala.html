@(title : String)(lecture : de.phoenix.rs.entity.PhoenixLecture)
@head={
	<!doctype html>
	<script type="text/javascript">
	$(document).ready(function(){

		var detail2 = false;
		var detail3 = false;
		var notNumber = /\D+/;
		var splChars =/^.*?(?=[\^#%&$\*:;!\"�<>\?/\{\|\}@@]).*$/;
		
		for(var i = 2; i <= "@lecture.getLectureDetails().size()"; i++){
			$("#moreDetails").click();
		}	
		
		@if(lecture.getTitle()!=""){
			$('#Submit').val('Update');
			$('#title').val(@lecture.getTitle());
		}

		
		@for(index <- 0 to lecture.getLectureDetails().size()-1){
			document.getElementsByName("room_"+(@index+1).toString())[0].value = "@lecture.getLectureDetails().get(index).getRoom()";
			document.getElementsByName("day_"+(@index+1).toString())[0].selectedIndex = @lecture.getLectureDetails().get(index).getWeekday().getDateTimeConstant()-1;
			document.getElementsByName("startTime_"+(@index+1).toString())[0].value = "@lecture.getLectureDetails().get(index).getStartTime().toString("HH:mm")";
			document.getElementsByName("endTime_"+(@index+1).toString())[0].value = "@lecture.getLectureDetails().get(index).getEndTime().toString("HH:mm")";
			document.getElementsByName("startDate_"+(@index+1).toString())[0].value = "@lecture.getLectureDetails().get(index).getStartDate().toString("YYYY-MM-dd")";
			document.getElementsByName("endDate_"+(@index+1).toString())[0].value = "@lecture.getLectureDetails().get(index).getEndDate().toString("YYYY-MM-dd")";
								
	
	
			@if(lecture.getLectureDetails().get(index).getInterval().getDays() > 0){
				document.getElementsByName("period_"+(@index+1).toString())[0].value = @lecture.getLectureDetails().get(index).getInterval().getDays();
				document.getElementsByName("periodDD_"+(@index+1).toString())[0].selectedIndex = 0;
			}else{
				@if(lecture.getLectureDetails().get(index).getInterval().getWeeks() > 0){
				document.getElementsByName("period_"+(@index+1).toString())[0].value = @lecture.getLectureDetails().get(index).getInterval().getWeeks();
				document.getElementsByName("periodDD_"+(@index+1).toString())[0].selectedIndex = 1;
				}else{
					@if(lecture.getLectureDetails().get(index).getInterval().getMonths() > 0){
					document.getElementsByName("period_"+(@index+1).toString())[0].value = @lecture.getLectureDetails().get(index).getInterval().getMonths();
					document.getElementsByName("periodDD_"+(@index+1).toString())[0].selectedIndex = 2;
					}
				}
			}
		}
		
		
		$(document).on('change', '.Number', function(){	
			if(notNumber.test($(this).val())){
				$(this).val("0");
				alert('Bitte hier eine Nummer eingeben.'); 
			}
		});	
		
		$(document).on('blur', '.Date', function(){
			var year = parseInt($(this).val().slice(0, 4));
			if(year <= 1583 || year >= 9999){
				$(this).val("@util.TimeGroup.now("Y-MM-dd")");
			    alert("Die Gregorianer werden Böse!"); 
			    $(this).focus();
			}
		});
		
		$("#lectureDetail").on('change', '.Text', function(){	
			if(splChars.test($(this).val())){
				$(this).val('');
			    alert("Illegal characters detected!"); 
			    $(this).focus(); 
			}
		});
		
		$("#title").change(function(){
			if(splChars.test($(this).val())){
				$(this).val('');
			    alert ("Illegal characters detected!"); 
			    $(this).focus(); 
			}
		});
		
	    $(document).on('change', 'input:radio[name="weekDay"]', function (event) {
	        $(this).parents(".buttonGroupParent").children(".hiddenInput").val($(this).val());
	    });
	    
   	    $(document).on('change', 'input:radio[name="period"]', function (event) {
	        $(this).parents(".buttonPeriodParent").children(".hiddenPeriod").val($(this).val());
	    });
		
	});
  		
	function checkLecture(inhalt)
	{
		$.get('/existLecture',
			      {'title': inhalt})
			      .success(function(data) {
		    		  	alert("Diese Veranstaltung ist schon vorhanden!");
		        	  	$("#title").val("");
			      })
	}
	</script>
	<link rel="stylesheet" type="text/css" href="/assets/stylesheets/createLecture.css" />
}

@Structure(title)(head){
	<!-- Hauptueberschrift -->
	<h2 class="maintitle"> Veranstaltung erstellen </h2>
	<div class="alert alert-info">
			<form action="/sendLecture" method="post" onsubmit="return ValidateForm(this);" id="form1">
			
				<input type="hidden" name="oldLecture" value="@lecture.getTitle()"/>
				<table style="width:100%">
					<td style="width:40%">Titel:</td>
					<td style="width:60%"></td>
				</table>
				<table style="width:100%">
					<td style="width:40%; vertical-align:top">
						<input type="text" class="form-control round-corners Text" placeholder="Tragen Sie hier den Titel ein" name="title" id="title" onchange="checkLecture(this.value)" style="width:100%">
					</td>
					<td style="width:60%"></td>			
				</table><br>
				Beschreibung:<br>
				<textarea class="form-control round-corners" rows="3" name="description"></textarea>
				<br>
				
				<div id="lectureDetail">
				 <div class="well">
					<table style="width:100%" class="parentTable">					
						<td style="width:50%">
	 							<h4>Termin #1</h4>  
						</td>
						<td style="width:50%">
								<a href="#" style="color:red; float:right" class="removeDetails">
									<font color="red"><div class="glyphicon glyphicon-remove"></div></font>
								</a>
						</td>
					</table>
					
					<table style="width:100%">	
					<tr>
						<td style="width:50%">Raum:</td>
						<td style="width:50%"></td>
					</tr>
					<tr>				
						<td style="width:50%">
	 							<input type="text" name="room_1" class="Text form-control round-corners" placeholder="Tragen Sie hier den Raum ein">  
						</td>
						<td style="width:50%"></td>
					</tr>
					</table><br>
	
					<div class="buttonGroupParent">
				        <input type="hidden" name="day_1" value="monday" class="hiddenInput">	
						<div class="btn-group" data-toggle="buttons">
						  <label class="btn btn-default">
						    <input type="radio" name="weekDay" value="monday"> Montag
						  </label>
						  <label class="btn btn-default">
						    <input type="radio" name="weekDay" value="tuesday"> Dienstag
						  </label>
						  <label class="btn btn-default">
						    <input type="radio" name="weekDay" value="wednesday"> Mittwoch
						  </label>
							  <label class="btn btn-default">
						    <input type="radio" name="weekDay" value="thursday"> Donnerstag
						  </label>
	 						  <label class="btn btn-default">
						    <input type="radio" name="weekDay" value="friday"> Freitag
						  </label>
	 						  <label class="btn btn-default">
						    <input type="radio" name="weekDay" value="saturday"> Samstag
						  </label>
	 						  <label class="btn btn-default">
						    <input type="radio" name="weekDay" value="sunday"> Sonntag
						  </label>
						</div>	
					</div><br>
					
					<table style="width:100%">
						<tr>
							<td style="width:20%">
								Startzeit:
							</td>
							<td style="width:15%"></td>	
							<td style="width:20%">
								Endzeit:
							</td>
							<td style="width:45%"></td>							
						</tr>
						<tr>
							<td style="width:20%">
								<input type="time" name="startTime_1" value="00:00" class="Time form-control round-corners">
							</td>
							<td style="width:15%; text-align:center">bis</td>
							<td style="width:20%">
								<input type="time" name="endTime_1" value="00:00" class="Time form-control round-corners">
							</td>
							<td style="width:45%"></td>
						</tr>					
					</table><br>
					
	                	<table style="width:100%">
						<tr>
							<td style="width:20%">
			                        <input type="text" class="form-control round-corners Number" placeholder="Periode" name="period_1">
							</td>
							<td style="width:60%">	
								<div class="buttonPeriodParent">
							        <input type="hidden" name="periodDD_1" value="weeks" class="hiddenPeriod">	
									<div class="btn-group" data-toggle="buttons">
									  <label class="btn btn-default">
									    <input type="radio" name="period" value="days"> Tag(e)
									  </label>
			  						  <label class="btn btn-default">
									    <input type="radio" name="period" value="weeks"> Woche(n)
									  </label>
			  						  <label class="btn btn-default">
									    <input type="radio" name="period" value="months"> Monat(e)
									  </label>
									 </div>
								</div>
								</td>
								<td style="width:20%"></td>
							</tr>
						</table><br>
	
	                 <table style="width:100%">
						<tr>
							<td style="width:20%">
								Startdatum:
							</td>
							<td style="width:15%"></td>	
							<td style="width:20%">
								Enddatum:
							</td>
							<td style="width:45%"></td>							
						</tr>
						<tr>
							<td style="width:20%">
								<input type="date" name="startDate_1" value="@util.TimeGroup.now("Y-MM-dd")" class="Date form-control round-corners" min="1584-01-01" max="9998-12-31">
							</td>
							<td style="width:15%; text-align:center">bis</td>
							<td style="width:20%">
								<input type="date" name="endDate_1" value="@util.TimeGroup.now("Y-MM-dd")" class="Date form-control round-corners" min="1584-01-01" max="9998-12-31">
							</td>
							<td style="width:45%"></td>
						</tr>					
					</table>
					</div>
				</div>		
				<input type="button" id="moreDetails" value="weiteren Termin" class="btn btn-primary"/>
				<br><br>
				<input id="Submit" name="submit" type="submit" value="Create" class="btn btn-success"/>
			</form> 
	</div>
	
}